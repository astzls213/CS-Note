# Part4 网络层/链路层/物理层

本总结主要面向在校大学生**复习期末考试**，当然也能应付一些**面试**上的问题。这些总结都是作者**有感而发**，因此**不是那种被转发到臭的博文**。因此，各位水友看完觉得有收获可以**点个赞**满足博主那可怜的虚荣心。

总结由于俺龙鸣的学识以及时间有限，难免有错，感谢各路大神不吝赐教。

### 简介

我把网络层、链路层和物理层合在一起讲，是因为这三个东西关联度很大，我不想拆开来讲，你会发现这样更加容易理解。

### 一些概念

我们现在想要从主机A发送一个TCP分组至主机B，主机A和B相距十万八千里。因此不存在一条直达的网线连接这两台主机，实际上，我们的分组要经过一系列的“中转”来到达目的主机B，因此我们的分组要在若干条直连的链路（网线，无线电波等）到达目的主机B。

我们现在先抽象一下，我们就把这若干条直连的链路抽象成一条虚拟链路，这样分组就好像是在一条直连的链路上传输，网络层就是在干这件事！

因此，具体落实到真实的直连物理链路，即落实到两个网卡之间的数据运输，就是链路层所做的事。链路可能是铜线，也可能是无线电波，

### 灵魂拷问环节

1. 为什么需要网络层？

   如果没有网络层，我们说过，主机A与主机B通常相距很远，不存在直连的链路，因此分组会先被发送到与主机A直接相连的路由器上，让路由器再去分发，直到分组被这样接力的传送到主机B上。

   那么问题来了，路由器怎么知道要分发给谁？你可能会说，用主机B网卡的那个MAC地址啊。好，即便如此，由于MAC地址被杂乱无章的散落在世界各地，根本不能有一个有效的算法，使得给定一个MAC地址来确定他所属的局域网。

   因此我们引入IP地址，使局域网下的IP地址是在某段**连续的范围**内的，比如：122.122.122.1～122.122.122.254，这样我们路由器就容易实现分发算法了。注意到这段区域都是122.122.122.x这样，也即，路由器通过解析目的IP地址，比如122.122.122.34，他就知道他应该转发至与122.122.122.x所连接的那个路由器那里。如果不使用IP地址，仅靠MAC地址是不可能做到的。因为你可能需要构造很多很多的表项，来确定某MAC地址应该从哪个接口出去。

2. 简述路由器工作原理。

   路由器首先取得你的目的IP地址，然后与路由器维护的一个**转发表**进行匹配，得知该IP数据报应该从哪个出口出去。这里有两个动作，即先**路由选择**，再**转发**。

   目的IP地址可能与多个表项匹配，路由器会选择最佳匹配那个，这就是所谓的**最长前缀匹配规则**。

   现在，唯一不确定的就是如何构造转发表。秘密在**路由信息协议RIP**和**开放最短路径优先协议OSPF**。

3. 简述路由信息协议。

4. 简述开放最短路径优先协议。

5. IP首部的校验和计算方法。

6. 简述IPv4和IPv6的区别。

7. IPv4和IPv6如何过渡？

8. 说说VPN中3个专用地址块。

9. 简述NAT工作原理。

好，现在问问你链路层和物理层的问题。

1. 链路一般划分成哪两种？
2. 链路层主要在干嘛？
3. 如何获取目的主机MAC地址？
4. 简述两个不同子网的端通过ARP协议获取对方的MAC地址的过程。
5. 主机共享链路时如何避免传输冲突？
6. CSMA/CD为什么争用期为两倍的信道传播时延？
7. 为什么以太网帧有最小长度和最大长度要求？
8. 链路层是如何进行差错检验的？
9. 简单说下集线器，交换机，网桥的概念。
10. 什么是100BASE-T以太网？
11. 简述虚拟局域网工作原理。
12. 什么是单工/半双工/双工信道？
13. 什么是曼彻斯特编码？
14. 什么是信噪比？
15. 简述信道复用技术。
16. 宽带接入技术有哪些？

### 总结